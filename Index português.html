<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FabricateHub | Marketplace de Fabricação de Peças Personalizadas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@600;700&display=swap"
    rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script
    const SUPABASE_URL = 'https://evojynztlxbcyfsujtoy.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_4zP3E8RmCti-qSJ8sGHvNw_HgH15MQm';
    const supabase = supabase.createClient(https://evojynztlxbcyfsujtoy.supabase.co, sb_publishable_4zP3E8RmCti-qSJ8sGHvNw_HgH15MQm);
    console.log('Supabase conectado:', supabase);></script>
     <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
   <script>
   const supabase = supabase.createClient(
       'https://evojynztlxbcyfsujtoy.supabase.co',
       'sb_publishable_4zP3E8RmCti-qSJ8sGHvNw_HgH15MQm'
   );
   </script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --accent: #8b5cf6;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #6b7280;
            --light-gray: #e5e7eb;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: var(--light);
        }

        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Cabeçalho */
        header {
            background-color: white;
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            cursor: pointer;
        }

        .logo i {
            font-size: 2rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        nav a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: var(--transition);
            padding: 5px 0;
            position: relative;
            cursor: pointer;
        }

        nav a:hover {
            color: var(--primary);
        }

        nav a.active {
            color: var(--primary);
        }

        nav a.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary);
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            color: var(--dark);
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-type-badge {
            background-color: var(--secondary);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #0da271;
        }

        .btn-accent {
            background-color: var(--accent);
            color: white;
        }

        .btn-accent:hover {
            background-color: #7c3aed;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .btn-large {
            padding: 14px 28px;
            font-size: 1.1rem;
        }

        /* Conteúdo da Página */
        .page-container {
            min-height: calc(100vh - 200px);
            padding: 40px 0;
            display: none;
        }

        .page-container.active {
            display: block;
        }

        .page-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title h1 {
            font-size: 2.2rem;
        }

        .page-title .page-subtitle {
            color: var(--gray);
            font-weight: 400;
            font-size: 1rem;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background-color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-icon.blue {
            background-color: #dbeafe;
            color: var(--primary);
        }

        .stat-icon.green {
            background-color: #d1fae5;
            color: var(--secondary);
        }

        .stat-icon.orange {
            background-color: #fed7aa;
            color: #f97316;
        }

        .stat-icon.purple {
            background-color: #e9d5ff;
            color: var(--accent);
        }

        .stat-info h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--gray);
        }

        /* Estilos de Tabela */
        .table-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            margin-bottom: 40px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        .table-header h3 {
            margin: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            padding: 15px 20px;
            background-color: #f8fafc;
            border-bottom: 1px solid var(--light-gray);
            font-weight: 600;
            color: var(--dark);
        }

        td {
            padding: 15px 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: #f9fafb;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
        }

        .status-quoted {
            background-color: #dbeafe;
            color: var(--primary);
        }

        .status-in-progress {
            background-color: #f3e8ff;
            color: #7c3aed;
        }

        .status-completed {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-cancelled {
            background-color: #f1f5f9;
            color: var(--gray);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-icon {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* Abas */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            white-space: nowrap;
        }

        .tab:hover {
            color: var(--primary);
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards */
        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .card-title h3 {
            margin-bottom: 5px;
        }

        .card-meta {
            display: flex;
            gap: 20px;
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .card-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .detail-value {
            font-weight: 500;
        }

        .card-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Página Inicial */
        .hero {
            background: linear-gradient(135deg, #f0f7ff 0%, #e6f0ff 100%);
            padding: 80px 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--gray);
            max-width: 700px;
            margin: 0 auto 40px;
        }

        .hero-btns {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .file-types {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .file-type-tag {
            background-color: #e0e7ff;
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Seção de Upload */
        .upload-section {
            background-color: #f8fafc;
            padding: 60px 0;
        }

        .upload-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .upload-area {
            width: 100%;
            background-color: white;
            border: 2px dashed var(--light-gray);
            border-radius: var(--border-radius);
            padding: 60px 20px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area:hover {
            border-color: var(--primary);
        }

        .upload-area.dragover {
            border-color: var(--primary);
            background-color: #f0f7ff;
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 20px;
        }

        .upload-area h3 {
            margin-bottom: 10px;
        }

        /* Formulários */
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border-radius: var(--border-radius);
            border: 1px solid var(--light-gray);
            font-family: 'Roboto', sans-serif;
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* Modais */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--light-gray);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            background-color: var(--light-gray);
        }

        /* Notificação */
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 500;
            box-shadow: var(--box-shadow);
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
        }

        .notification.active {
            transform: translateX(0);
        }

        .notification-success {
            background-color: var(--secondary);
        }

        .notification-error {
            background-color: var(--danger);
        }

        .notification-info {
            background-color: var(--primary);
        }

        .notification-warning {
            background-color: var(--warning);
        }

        /* Métodos de Fabricação */
        .methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }

        .method-card {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            cursor: pointer;
        }

        .method-card:hover {
            transform: translateY(-5px);
        }

        .method-header {
            background-color: #dbeafe;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .method-icon {
            width: 50px;
            height: 50px;
            background-color: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .method-body {
            padding: 20px;
        }

        .method-body ul {
            list-style-position: inside;
            color: var(--gray);
        }

        .method-body li {
            margin-bottom: 8px;
        }

        /* Cards de Orçamento */
        .quote-card {
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            transition: var(--transition);
        }

        .quote-card:hover {
            border-color: var(--primary);
            background-color: #f8fafc;
        }

        .quote-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .quote-card-actions {
            display: flex;
            gap: 10px;
        }

        /* Rodapé */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 60px 0 30px;
        }

        .footer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h3 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: white;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column a {
            color: #d1d5db;
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
        }

        .footer-column a:hover {
            color: white;
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid #374151;
            color: #9ca3af;
            font-size: 0.9rem;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .hero h1 {
                font-size: 2.2rem;
            }
            
            .hero-btns {
                flex-direction: column;
                align-items: center;
            }
            
            .page-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .card-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .card-actions {
                justify-content: flex-start;
                flex-wrap: wrap;
            }
            
            th, td {
                padding: 10px 15px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
        }
    </style>
</head>
<body>
    <!-- Cabeçalho -->
    <header>
        <div class="container header-container">
            <div class="logo" id="logo">
                <i class="fas fa-industry"></i>
                <span>FabricateHub</span>
            </div>
            <nav>
                <ul>
                    <li><a id="nav-home" class="nav-link active">Início</a></li>
                    <li><a id="nav-client" class="nav-link">Painel do Cliente</a></li>
                    <li><a id="nav-fabricator" class="nav-link">Painel do Fabricante</a></li>
                    <li><a id="nav-methods" class="nav-link">Métodos de Fabricação</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">JD</div>
                    <div>
                        <div id="user-name">João Designer</div>
                        <div class="user-type-badge" id="user-type-badge">Cliente</div>
                    </div>
                </div>
                <button class="btn btn-outline" id="logout-btn">Sair</button>
            </div>
        </div>
    </header>

    <!-- Área de Notificação -->
    <div id="notification-area"></div>

    <!-- Página Inicial -->
    <div id="home-page" class="page-container active">
        <section class="hero">
            <div class="container">
                <h1>Conecte-se com Fabricantes para Peças Personalizadas</h1>
                <p>Faça upload dos seus arquivos de engenharia (STL, STEP, DXF) e receba orçamentos de fabricantes independentes especializados em usinagem, corte a laser, soldagem, manufatura 3D, prototipagem, fabricação em madeira e muito mais.</p>
                <div class="hero-btns">
                    <button class="btn btn-primary btn-large" id="get-quote-btn">
                        <i class="fas fa-upload"></i> Solicitar Orçamento
                    </button>
                    <button class="btn btn-outline btn-large" id="browse-manufacturers-btn">
                        <i class="fas fa-search"></i> Buscar Fabricantes
                    </button>
                </div>
                <div class="file-types">
                    <span class="file-type-tag">STL</span>
                    <span class="file-type-tag">STEP</span>
                    <span class="file-type-tag">IGES</span>
                    <span class="file-type-tag">DXF</span>
                    <span class="file-type-tag">DWG</span>
                    <span class="file-type-tag">SLDPRT</span>
                    <span class="file-type-tag">3DM</span>
                    <span class="file-type-tag">OBJ</span>
                </div>
            </div>
        </section>

        <section class="upload-section">
            <div class="container">
                <div class="section-title">
                    <h2>Envie Seu Projeto</h2>
                    <p>Receba orçamentos instantâneos enviando seus arquivos de engenharia</p>
                </div>
                <div class="upload-container">
                    <div class="upload-area" id="upload-area">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Arraste e Solte Seus Arquivos Aqui</h3>
                        <p>ou clique para procurar arquivos no seu computador</p>
                        <div class="file-types">
                            <span class="file-type-tag">STL</span>
                            <span class="file-type-tag">STEP</span>
                            <span class="file-type-tag">IGES</span>
                            <span class="file-type-tag">DXF</span>
                            <span class="file-type-tag">DWG</span>
                            <span class="file-type-tag">PDF</span>
                        </div>
                        <input type="file" id="file-input" multiple style="display: none;">
                    </div>
                    
                    <div class="form-container">
                        <form id="project-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="project-name">Nome do Projeto</label>
                                    <input type="text" id="project-name" placeholder="Ex: Invólucro de Alumínio" required>
                                </div>
                                <div class="form-group">
                                    <label for="project-quantity">Quantidade</label>
                                    <input type="number" id="project-quantity" min="1" value="1" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="project-material">Material</label>
                                    <select id="project-material" required>
                                        <option value="">Selecione o Material</option>
                                        <option value="aluminum">Alumínio</option>
                                        <option value="steel">Aço</option>
                                        <option value="stainless-steel">Aço Inoxidável</option>
                                        <option value="brass">Latão</option>
                                        <option value="plastic">Plástico</option>
                                        <option value="wood">Madeira</option>
                                        <option value="other">Outro</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="project-method">Método de Fabricação</label>
                                    <select id="project-method" required>
                                        <option value="">Selecione o Método</option>
                                        <option value="cnc-machining">Usinagem CNC</option>
                                        <option value="laser-cutting">Corte a Laser</option>
                                        <option value="3d-printing">Impressão 3D</option>
                                        <option value="prototyping">Prototipagem</option>
                                        <option value="welding">Soldagem</option>
                                        <option value="wood-fabrication">Fabricação em Madeira</option>
                                        <option value="sheet-metal">Chapa Metálica</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="project-due-date">Data de Conclusão Desejada</label>
                                <input type="date" id="project-due-date" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="project-description">Descrição do Projeto e Requisitos</label>
                                <textarea id="project-description" rows="4" placeholder="Descreva seu projeto, requisitos especiais, tolerâncias, acabamento superficial, etc." required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">
                                    <i class="fas fa-paper-plane"></i> Enviar Projeto para Orçamentos
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Painel do Cliente -->
    <div id="client-page" class="page-container">
        <div class="container">
            <div class="page-title">
                <div>
                    <h1>Painel do Cliente</h1>
                    <div class="page-subtitle">Gerencie seus projetos e orçamentos</div>
                </div>
                <button class="btn btn-primary" id="new-project-btn">
                    <i class="fas fa-plus"></i> Novo Projeto
                </button>
            </div>
            
            <div class="dashboard-stats">
                <div class="stat-card" id="total-projects-stat">
                    <div class="stat-icon blue">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-projects-count">0</h3>
                        <p>Total de Projetos</p>
                    </div>
                </div>
                <div class="stat-card" id="pending-quotes-stat">
                    <div class="stat-icon orange">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="pending-quotes-count">0</h3>
                        <p>Orçamentos Pendentes</p>
                    </div>
                </div>
                <div class="stat-card" id="active-projects-stat">
                    <div class="stat-icon purple">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="active-projects-count">0</h3>
                        <p>Projetos Ativos</p>
                    </div>
                </div>
                <div class="stat-card" id="total-spent-stat">
                    <div class="stat-icon green">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-spent-amount">R$ 0</h3>
                        <p>Total Gasto</p>
                    </div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="client-all">Todos os Projetos</div>
                <div class="tab" data-tab="client-pending">Orçamentos Pendentes</div>
                <div class="tab" data-tab="client-active">Projetos Ativos</div>
                <div class="tab" data-tab="client-completed">Concluídos</div>
            </div>
            
            <div id="client-all" class="tab-content active">
                <div class="table-container">
                    <div class="table-header">
                        <h3>Meus Projetos</h3>
                        <div>
                            <select id="client-project-sort" class="project-sort">
                                <option value="newest">Ordenar por: Mais Recentes</option>
                                <option value="oldest">Ordenar por: Mais Antigos</option>
                                <option value="name">Ordenar por: Nome</option>
                                <option value="status">Ordenar por: Status</option>
                            </select>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Nome do Projeto</th>
                                <th>Data</th>
                                <th>Método</th>
                                <th>Orçamentos</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="client-projects-table">
                            <!-- Projetos do cliente serão populados aqui por JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="client-pending" class="tab-content">
                <div id="client-pending-projects">
                    <!-- Projetos pendentes serão populados aqui por JavaScript -->
                </div>
            </div>
            
            <div id="client-active" class="tab-content">
                <div id="client-active-projects">
                    <!-- Projetos ativos serão populados aqui por JavaScript -->
                </div>
            </div>
            
            <div id="client-completed" class="tab-content">
                <div id="client-completed-projects">
                    <!-- Projetos concluídos serão populados aqui por JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Painel do Fabricante -->
    <div id="fabricator-page" class="page-container">
        <div class="container">
            <div class="page-title">
                <div>
                    <h1>Painel do Fabricante</h1>
                    <div class="page-subtitle">Encontre projetos e envie orçamentos</div>
                </div>
                <button class="btn btn-outline" id="update-capabilities-btn">
                    <i class="fas fa-edit"></i> Atualizar Capacidades
                </button>
            </div>
            
            <div class="dashboard-stats">
                <div class="stat-card" id="active-requests-stat">
                    <div class="stat-icon blue">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="active-requests-count">0</h3>
                        <p>Solicitações Ativas</p>
                    </div>
                </div>
                <div class="stat-card" id="quotes-submitted-stat">
                    <div class="stat-icon orange">
                        <i class="fas fa-file-signature"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="quotes-submitted-count">0</h3>
                        <p>Orçamentos Enviados</p>
                    </div>
                </div>
                <div class="stat-card" id="jobs-completed-stat">
                    <div class="stat-icon green">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="jobs-completed-count">0</h3>
                        <p>Trabalhos Concluídos</p>
                    </div>
                </div>
                <div class="stat-card" id="rating-stat">
                    <div class="stat-icon purple">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="rating-value">0.0</h3>
                        <p>Avaliação Média</p>
                    </div>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="fabricator-new">Novas Solicitações</div>
                <div class="tab" data-tab="fabricator-quotes">Meus Orçamentos</div>
                <div class="tab" data-tab="fabricator-active">Trabalhos Ativos</div>
                <div class="tab" data-tab="fabricator-completed">Trabalhos Concluídos</div>
            </div>
            
            <div id="fabricator-new" class="tab-content active">
                <div id="fabricator-new-requests">
                    <!-- Novas solicitações serão populadas aqui por JavaScript -->
                </div>
            </div>
            
            <div id="fabricator-quotes" class="tab-content">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Projeto</th>
                                <th>Cliente</th>
                                <th>Valor do Orçamento</th>
                                <th>Data de Envio</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="fabricator-quotes-table">
                            <!-- Orçamentos enviados serão populados aqui por JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="fabricator-active" class="tab-content">
                <div id="fabricator-active-jobs">
                    <!-- Trabalhos ativos serão populados aqui por JavaScript -->
                </div>
            </div>
            
            <div id="fabricator-completed" class="tab-content">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Projeto</th>
                                <th>Cliente</th>
                                <th>Data de Conclusão</th>
                                <th>Valor</th>
                                <th>Avaliação</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="fabricator-completed-table">
                            <!-- Trabalhos concluídos serão populados aqui por JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Página de Métodos de Fabricação -->
    <div id="methods-page" class="page-container">
        <div class="container">
            <div class="page-title">
                <h1>Métodos de Fabricação</h1>
                <div class="page-subtitle">Explore nossas capacidades de manufatura</div>
            </div>
            
            <div class="methods-grid">
                <div class="method-card" data-method="cnc-machining">
                    <div class="method-header">
                        <div class="method-icon">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3>Usinagem CNC</h3>
                    </div>
                    <div class="method-body">
                        <p>Usinagem de precisão de metais e plásticos com tolerâncias apertadas.</p>
                        <ul>
                            <li>Fresamento 3, 4 e 5 eixos</li>
                            <li>Torno e trabalho de torno</li>
                            <li>Geometrias complexas</li>
                            <li>Tolerâncias até ±0,001"</li>
                        </ul>
                        <button class="btn btn-outline btn-small" style="margin-top: 15px;" data-method-detail="cnc-machining">Ver Detalhes</button>
                    </div>
                </div>
                
                <div class="method-card" data-method="laser-cutting">
                    <div class="method-header">
                        <div class="method-icon">
                            <i class="fas fa-cut"></i>
                        </div>
                        <h3>Corte a Laser</h3>
                    </div>
                    <div class="method-body">
                        <p>Corte de precisão de chapas metálicas e ligas com bordas limpas.</p>
                        <ul>
                            <li>Aço, alumínio, latão</li>
                            <li>Espessura até 1"</li>
                            <li>Designs intricados</li>
                            <li>Entrega rápida</li>
                        </ul>
                        <button class="btn btn-outline btn-small" style="margin-top: 15px;" data-method-detail="laser-cutting">Ver Detalhes</button>
                    </div>
                </div>
                
                <div class="method-card" data-method="3d-printing">
                    <div class="method-header">
                        <div class="method-icon">
                            <i class="fas fa-print"></i>
                        </div>
                        <h3>Impressão 3D</h3>
                    </div>
                    <div class="method-body">
                        <p>Manufatura aditiva que constrói peças camada por camada a partir de modelos digitais.</p>
                        <ul>
                            <li>FDM, SLA, SLS, Impressão 3D em Metal</li>
                            <li>Prototipagem rápida</li>
                            <li>Protótipos funcionais</li>
                            <li>Produção de baixo volume</li>
                        </ul>
                        <button class="btn btn-outline btn-small" style="margin-top: 15px;" data-method-detail="3d-printing">Ver Detalhes</button>
                    </div>
                </div>
                
                <div class="method-card" data-method="prototyping">
                    <div class="method-header">
                        <div class="method-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <h3>Prototipagem</h3>
                    </div>
                    <div class="method-body">
                        <p>Serviços de prototipagem rápida para validação de design, testes e apresentação.</p>
                        <ul>
                            <li>Modelos conceituais</li>
                            <li>Protótipos funcionais</li>
                            <li>Validação de design</li>
                            <li>Desenvolvimento iterativo</li>
                        </ul>
                        <button class="btn btn-outline btn-small" style="margin-top: 15px;" data-method-detail="prototyping">Ver Detalhes</button>
                    </div>
                </div>
                
                <div class="method-card" data-method="wood-fabrication">
                    <div class="method-header">
                        <div class="method-icon">
                            <i class="fas fa-tree"></i>
                        </div>
                        <h3>Fabricação em Madeira</h3>
                    </div>
                    <div class="method-body">
                        <p>Serviços de marcenaria e carpintaria personalizados para móveis, elementos arquitetônicos e peças decorativas.</p>
                        <ul>
                            <li>Roteamento CNC em madeira</li>
                            <li>Móveis personalizados</li>
                            <li>Marcenaria arquitetônica</li>
                            <li>Acabamento e tingimento</li>
                        </ul>
                        <button class="btn btn-outline btn-small" style="margin-top: 15px;" data-method-detail="wood-fabrication">Ver Detalhes</button>
                    </div>
                </div>
                
                <div class="method-card" data-method="welding">
                    <div class="method-header">
                        <div class="method-icon">
                            <i class="fas fa-fire"></i>
                        </div>
                        <h3>Soldagem e Fabricação</h3>
                    </div>
                    <div class="method-body">
                        <p>Serviços de fabricação e soldagem metálica para componentes estruturais, quadros e montagens personalizadas.</p>
                        <ul>
                            <li>Solda TIG (precisão)</li>
                            <li>Solda MIG (produção)</li>
                            <li>Solda com eletrodo revestido</li>
                            <li>Corte a plasma</li>
                            <li>Dobra e conformação de metais</li>
                        </ul>
                        <button class="btn btn-outline btn-small" style="margin-top: 15px;" data-method-detail="welding">Ver Detalhes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modais -->
    <div id="quote-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Enviar Orçamento</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="quote-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="quote-project-name">Projeto</label>
                        <input type="text" id="quote-project-name" readonly>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quote-amount">Valor do Orçamento (R$)</label>
                            <input type="number" id="quote-amount" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="quote-lead-time">Prazo de Entrega (Dias)</label>
                            <input type="number" id="quote-lead-time" min="1" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="quote-payment-terms">Condições de Pagamento</label>
                        <select id="quote-payment-terms" required>
                            <option value="">Selecione as Condições de Pagamento</option>
                            <option value="50% de entrada, 50% na conclusão">50% de entrada, 50% na conclusão</option>
                            <option value="100% na conclusão">100% na conclusão</option>
                            <option value="30 dias">30 dias</option>
                            <option value="Other">Outro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="quote-notes">Observações para o Cliente</label>
                        <textarea id="quote-notes" rows="4" placeholder="Quaisquer observações especiais, condições ou esclarecimentos sobre seu orçamento..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline close-modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Enviar Orçamento</button>
                </div>
            </form>
        </div>
    </div>

    <div id="project-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalhes do Projeto</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="project-detail-content">
                    <!-- Detalhes do projeto serão populados aqui por JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline close-modal">Fechar</button>
            </div>
        </div>
    </div>

    <div id="method-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="method-detail-title"></h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="method-detail-content">
                    <!-- Detalhes do método serão populados aqui por JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline close-modal">Fechar</button>
                <button type="button" class="btn btn-primary" id="method-browse-projects">Buscar Projetos</button>
            </div>
        </div>
    </div>

    <div id="capabilities-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Atualizar Capacidades de Fabricação</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="capabilities-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label>Métodos de Fabricação</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                            <div>
                                <input type="checkbox" id="cap-cnc" value="cnc-machining" checked>
                                <label for="cap-cnc">Usinagem CNC</label>
                            </div>
                            <div>
                                <input type="checkbox" id="cap-laser" value="laser-cutting" checked>
                                <label for="cap-laser">Corte a Laser</label>
                            </div>
                            <div>
                                <input type="checkbox" id="cap-3d" value="3d-printing" checked>
                                <label for="cap-3d">Impressão 3D</label>
                            </div>
                            <div>
                                <input type="checkbox" id="cap-prototype" value="prototyping" checked>
                                <label for="cap-prototype">Prototipagem</label>
                            </div>
                            <div>
                                <input type="checkbox" id="cap-wood" value="wood-fabrication">
                                <label for="cap-wood">Fabricação em Madeira</label>
                            </div>
                            <div>
                                <input type="checkbox" id="cap-welding" value="welding">
                                <label for="cap-welding">Soldagem</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cap-min-order">Valor Mínimo do Pedido (R$)</label>
                            <input type="number" id="cap-min-order" min="0" value="100">
                        </div>
                        <div class="form-group">
                            <label for="cap-max-size">Tamanho Máximo da Peça (cm)</label>
                            <input type="text" id="cap-max-size" placeholder="60x60x60">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="cap-lead-time">Prazo de Entrega Típico (Dias)</label>
                        <input type="number" id="cap-lead-time" min="1" value="14">
                    </div>
                    
                    <div class="form-group">
                        <label for="cap-materials">Materiais Disponíveis</label>
                        <textarea id="cap-materials" rows="3" placeholder="Liste os materiais com os quais você trabalha (separados por vírgula)"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline close-modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Capacidades</button>
                </div>
            </form>
        </div>
    </div>

    <div id="quote-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalhes do Orçamento</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="quote-detail-content">
                    <!-- Detalhes do orçamento serão populados aqui por JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline close-modal">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Rodapé -->
    <footer>
        <div class="container">
            <div class="footer-container">
                <div class="footer-column">
                    <h3>FabricateHub</h3>
                    <p style="color: #d1d5db; margin-bottom: 20px;">Conectando clientes com fabricantes para fabricação de peças personalizadas desde 2020.</p>
                    <div style="display: flex; gap: 15px;">
                        <a><i class="fab fa-linkedin fa-lg"></i></a>
                        <a><i class="fab fa-twitter fa-lg"></i></a>
                        <a><i class="fab fa-facebook fa-lg"></i></a>
                        <a><i class="fab fa-instagram fa-lg"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Para Clientes</h3>
                    <ul>
                        <li><a class="nav-link" data-page="home">Como Funciona</a></li>
                        <li><a id="pricing-link">Preços</a></li>
                        <li><a id="file-requirements-link">Requisitos de Arquivo</a></li>
                        <li><a id="material-guide-link">Guia de Materiais</a></li>
                        <li><a id="help-center-link">Central de Ajuda</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Para Fabricantes</h3>
                    <ul>
                        <li><a id="become-partner-link">Torne-se um Parceiro</a></li>
                        <li><a class="nav-link" data-page="fabricator">Painel do Fabricante</a></li>
                        <li><a id="capabilities-link">Verificação de Capacidade</a></li>
                        <li><a id="pricing-guidelines-link">Diretrizes de Preços</a></li>
                        <li><a id="manufacturer-resources-link">Recursos</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Empresa</h3>
                    <ul>
                        <li><a id="about-us-link">Sobre Nós</a></li>
                        <li><a id="blog-link">Blog</a></li>
                        <li><a id="careers-link">Carreiras</a></li>
                        <li><a id="contact-link">Contato</a></li>
                        <li><a id="privacy-link">Política de Privacidade</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 FabricateHub. Todos os direitos reservados. | Esta é uma interface de demonstração para um marketplace de fabricação de peças personalizadas.</p>
            </div>
        </div>
    </footer>

    <script>
        // ==================== ESTADO DA APLICAÇÃO ====================
        const AppState = {
            currentUser: {
                id: 1,
                name: "João Designer",
                type: "client", // "client" ou "fabricator"
                email: "joao.designer@exemplo.com"
            },
            
            projects: [
                {
                    id: 1,
                    name: "Invólucro de Alumínio",
                    clientId: 1,
                    clientName: "João Designer",
                    fileName: "invólucro_v2.stl",
                    fileSize: "4,2 MB",
                    date: "2023-10-15",
                    dueDate: "2023-11-15",
                    method: "cnc-machining",
                    material: "Alumínio 6061",
                    quantity: 10,
                    description: "Invólucro protótipo para dispositivo eletrônico com furos de montagem e slots de ventilação.",
                    status: "quoted", // "pending", "quoted", "accepted", "in-progress", "completed", "cancelled"
                    quotes: [
                        { id: 101, fabricatorId: 201, fabricatorName: "Usinagem de Precisão Ltda.", amount: 12450, leadTime: 14, date: "2023-10-16", status: "pending" },
                        { id: 102, fabricatorId: 202, fabricatorName: "Peças Rápidas", amount: 10500, leadTime: 21, date: "2023-10-17", status: "pending" }
                    ],
                    selectedQuoteId: null,
                    acceptedQuoteId: null
                },
                {
                    id: 2,
                    name: "Suporte de Aço",
                    clientId: 1,
                    clientName: "João Designer",
                    fileName: "suporte_final.dxf",
                    fileSize: "1,8 MB",
                    date: "2023-10-10",
                    dueDate: "2023-11-05",
                    method: "laser-cutting",
                    material: "Aço 3mm",
                    quantity: 50,
                    description: "Suporte de montagem para equipamento industrial com padrão preciso de furos.",
                    status: "pending",
                    quotes: [],
                    selectedQuoteId: null,
                    acceptedQuoteId: null
                },
                {
                    id: 3,
                    name: "Invólucro de Protótipo",
                    clientId: 1,
                    clientName: "João Designer",
                    fileName: "invólucro_proto.step",
                    fileSize: "3,5 MB",
                    date: "2023-10-05",
                    dueDate: "2023-10-25",
                    method: "3d-printing",
                    material: "ABS Plástico",
                    quantity: 5,
                    description: "Invólucro para protótipo eletrônico com fechamentos por encaixe.",
                    status: "in-progress",
                    quotes: [
                        { id: 103, fabricatorId: 203, fabricatorName: "Protótipos Rápidos Inc.", amount: 2250, leadTime: 7, date: "2023-10-06", status: "accepted" }
                    ],
                    selectedQuoteId: 103,
                    acceptedQuoteId: 103
                },
                {
                    id: 4,
                    name: "Base de Mesa Personalizada",
                    clientId: 1,
                    clientName: "João Designer",
                    fileName: "base_mesa.dwg",
                    fileSize: "2,1 MB",
                    date: "2023-09-28",
                    dueDate: "2023-10-20",
                    method: "wood-fabrication",
                    material: "Nogueira",
                    quantity: 1,
                    description: "Base de mesa personalizada com juntas intrincadas e superfícies acabadas.",
                    status: "completed",
                    quotes: [
                        { id: 104, fabricatorId: 204, fabricatorName: "Marcenaria Fina", amount: 6000, leadTime: 21, date: "2023-09-30", status: "completed" }
                    ],
                    selectedQuoteId: 104,
                    acceptedQuoteId: 104
                }
            ],
            
            fabricatorRequests: [
                {
                    id: 101,
                    name: "Conjunto de Engrenagens Personalizado",
                    clientId: 2,
                    clientName: "Motores de Precisão Inc.",
                    fileName: "engrenagens_v3.step",
                    fileSize: "5,2 MB",
                    date: "2023-10-18",
                    dueDate: "2023-11-15",
                    method: "cnc-machining",
                    material: "Aço 4140",
                    quantity: 25,
                    description: "Conjunto de 3 engrenagens de precisão com tolerâncias apertadas para aplicação industrial.",
                    status: "pending"
                },
                {
                    id: 102,
                    name: "Painel Arquitetônico",
                    clientId: 3,
                    clientName: "Design Build Co.",
                    fileName: "padrão_painel.dxf",
                    fileSize: "3,8 MB",
                    date: "2023-10-17",
                    dueDate: "2023-11-10",
                    method: "laser-cutting",
                    material: "Alumínio 5mm",
                    quantity: 12,
                    description: "Painel arquitetônico decorativo com padrão geométrico intrincado.",
                    status: "pending"
                },
                {
                    id: 103,
                    name: "Pés de Móveis",
                    clientId: 4,
                    clientName: "Modern Living LLC",
                    fileName: "pés_móveis.stl",
                    fileSize: "2,5 MB",
                    date: "2023-10-16",
                    dueDate: "2023-11-05",
                    method: "wood-fabrication",
                    material: "Carvalho",
                    quantity: 4,
                    description: "Conjunto de 4 pés de móveis com juntas personalizadas e design afunilado.",
                    status: "pending"
                }
            ],
            
            fabricatorQuotes: [
                {
                    id: 201,
                    projectId: 1,
                    projectName: "Invólucro de Alumínio",
                    clientId: 1,
                    clientName: "João Designer",
                    fabricatorId: 201,
                    fabricatorName: "Usinagem de Precisão Ltda.",
                    amount: 12450,
                    leadTime: 14,
                    date: "2023-10-16",
                    status: "pending", // "pending", "accepted", "rejected", "completed"
                    notes: "Inclui acabamento e inspeção. Requer 50% de entrada."
                },
                {
                    id: 202,
                    projectId: 3,
                    projectName: "Invólucro de Protótipo",
                    clientId: 1,
                    clientName: "João Designer",
                    fabricatorId: 203,
                    fabricatorName: "Protótipos Rápidos Inc.",
                    amount: 2250,
                    leadTime: 7,
                    date: "2023-10-06",
                    status: "accepted",
                    notes: "Impressão SLA padrão com lixamento leve."
                }
            ],
            
            fabricatorJobs: [
                {
                    id: 301,
                    projectId: 3,
                    projectName: "Invólucro de Protótipo",
                    clientId: 1,
                    clientName: "João Designer",
                    quoteId: 202,
                    startDate: "2023-10-08",
                    dueDate: "2023-10-25",
                    status: "in-progress",
                    progress: 75
                },
                {
                    id: 302,
                    projectId: 4,
                    projectName: "Base de Mesa Personalizada",
                    clientId: 1,
                    clientName: "João Designer",
                    quoteId: 104,
                    startDate: "2023-10-01",
                    dueDate: "2023-10-20",
                    status: "completed",
                    progress: 100,
                    rating: 5,
                    completedDate: "2023-10-18"
                }
            ],
            
            fabricatorCapabilities: {
                methods: ["cnc-machining", "laser-cutting", "3d-printing", "prototyping"],
                minOrder: 100,
                maxSize: "60x60x60",
                leadTime: 14,
                materials: "Alumínio, Aço, Aço Inoxidável, ABS, PLA, Nylon"
            },
            
            // Rastrear qual projeto está sendo orçado no momento
            currentQuoteProject: null
        };

        // ==================== ELEMENTOS DO DOM ====================
        const elements = {
            // Páginas
            pages: {
                home: document.getElementById('home-page'),
                client: document.getElementById('client-page'),
                fabricator: document.getElementById('fabricator-page'),
                methods: document.getElementById('methods-page')
            },
            
            // Navegação
            navLinks: document.querySelectorAll('.nav-link'),
            logo: document.getElementById('logo'),
            
            // Informações do usuário
            userName: document.getElementById('user-name'),
            userAvatar: document.getElementById('user-avatar'),
            userTypeBadge: document.getElementById('user-type-badge'),
            
            // Botões
            logoutBtn: document.getElementById('logout-btn'),
            getQuoteBtn: document.getElementById('get-quote-btn'),
            browseManufacturersBtn: document.getElementById('browse-manufacturers-btn'),
            newProjectBtn: document.getElementById('new-project-btn'),
            updateCapabilitiesBtn: document.getElementById('update-capabilities-btn'),
            
            // Modais
            modals: {
                quote: document.getElementById('quote-modal'),
                projectDetail: document.getElementById('project-detail-modal'),
                methodDetail: document.getElementById('method-detail-modal'),
                capabilities: document.getElementById('capabilities-modal'),
                quoteDetail: document.getElementById('quote-detail-modal')
            },
            
            // Formulários
            forms: {
                project: document.getElementById('project-form'),
                quote: document.getElementById('quote-form'),
                capabilities: document.getElementById('capabilities-form')
            },
            
            // Upload de arquivos
            uploadArea: document.getElementById('upload-area'),
            fileInput: document.getElementById('file-input'),
            
            // Abas
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            
            // Elementos de estatísticas
            statElements: {
                totalProjects: document.getElementById('total-projects-count'),
                pendingQuotes: document.getElementById('pending-quotes-count'),
                activeProjects: document.getElementById('active-projects-count'),
                totalSpent: document.getElementById('total-spent-amount'),
                activeRequests: document.getElementById('active-requests-count'),
                quotesSubmitted: document.getElementById('quotes-submitted-count'),
                jobsCompleted: document.getElementById('jobs-completed-count'),
                rating: document.getElementById('rating-value')
            },
            
            // Contêineres de conteúdo
            containers: {
                clientProjectsTable: document.getElementById('client-projects-table'),
                clientPendingProjects: document.getElementById('client-pending-projects'),
                clientActiveProjects: document.getElementById('client-active-projects'),
                clientCompletedProjects: document.getElementById('client-completed-projects'),
                fabricatorNewRequests: document.getElementById('fabricator-new-requests'),
                fabricatorQuotesTable: document.getElementById('fabricator-quotes-table'),
                fabricatorActiveJobs: document.getElementById('fabricator-active-jobs'),
                fabricatorCompletedTable: document.getElementById('fabricator-completed-table')
            }
        };

        // ==================== FUNÇÕES UTILITÁRIAS ====================
        const utils = {
            // Formatar moeda
            formatCurrency: (amount) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                }).format(amount);
            },
            
            // Formatar data
            formatDate: (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleDateString('pt-BR', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            },
            
            // Gerar ID único
            generateId: () => {
                return Date.now() + Math.floor(Math.random() * 1000);
            },
            
            // Mostrar notificação
            showNotification: (message, type = 'info', duration = 5000) => {
                const notificationArea = document.getElementById('notification-area');
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                `;
                
                notificationArea.appendChild(notification);
                
                // Acionar animação
                setTimeout(() => notification.classList.add('active'), 10);
                
                // Remover após a duração
                setTimeout(() => {
                    notification.classList.remove('active');
                    setTimeout(() => notification.remove(), 300);
                }, duration);
            },
            
            // Abrir modal
            openModal: (modalId) => {
                const modal = elements.modals[modalId];
                if (modal) {
                    modal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
            },
            
            // Fechar modal
            closeModal: (modalId) => {
                const modal = elements.modals[modalId];
                if (modal) {
                    modal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }
            },
            
            // Fechar todos os modais
            closeAllModals: () => {
                Object.keys(elements.modals).forEach(key => {
                    elements.modals[key].classList.remove('active');
                });
                document.body.style.overflow = 'auto';
            },
            
            // Obter badge de status HTML
            getStatusBadge: (status) => {
                const statusMap = {
                    'pending': { class: 'status-pending', text: 'Orçamentos Pendentes' },
                    'quoted': { class: 'status-quoted', text: 'Orçamentos Recebidos' },
                    'accepted': { class: 'status-in-progress', text: 'Orçamento Aceito' },
                    'in-progress': { class: 'status-in-progress', text: 'Em Andamento' },
                    'completed': { class: 'status-completed', text: 'Concluído' },
                    'cancelled': { class: 'status-cancelled', text: 'Cancelado' }
                };
                
                const statusInfo = statusMap[status] || { class: 'status-pending', text: 'Pendente' };
                return `<span class="status-badge ${statusInfo.class}">${statusInfo.text}</span>`;
            },
            
            // Obter ícone do método
            getMethodIcon: (method) => {
                const iconMap = {
                    'cnc-machining': 'cogs',
                    'laser-cutting': 'cut',
                    '3d-printing': 'print',
                    'prototyping': 'flask',
                    'wood-fabrication': 'tree',
                    'welding': 'fire',
                    'sheet-metal': 'layer-group'
                };
                return iconMap[method] || 'cogs';
            }
        };

        // ==================== FUNÇÕES DA APLICAÇÃO ====================
        const app = {
            // Inicializar a aplicação
            init: () => {
                app.setupEventListeners();
                app.loadUserData();
                app.updateUI();
                app.showPage('home');
                
                // Mostrar notificação de boas-vindas
                setTimeout(() => {
                    utils.showNotification(`Bem-vindo de volta, ${AppState.currentUser.name}!`, 'success');
                }, 1000);
            },
            
            // Configurar todos os ouvintes de evento
            setupEventListeners: () => {
                // Navegação
                elements.navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const page = link.id.replace('nav-', '');
                        app.showPage(page);
                    });
                });
                
                elements.logo.addEventListener('click', () => app.showPage('home'));
                
                // Troca de abas
                elements.tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        app.switchTab(tabId);
                    });
                });
                
                // Upload de arquivos
                elements.uploadArea.addEventListener('click', () => elements.fileInput.click());
                elements.uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    elements.uploadArea.classList.add('dragover');
                });
                elements.uploadArea.addEventListener('dragleave', () => {
                    elements.uploadArea.classList.remove('dragover');
                });
                elements.uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    elements.uploadArea.classList.remove('dragover');
                    const files = e.dataTransfer.files;
                    app.handleFileUpload(files);
                });
                elements.fileInput.addEventListener('change', (e) => {
                    const files = e.target.files;
                    app.handleFileUpload(files);
                });
                
                // Submissões de formulários
                elements.forms.project.addEventListener('submit', app.handleProjectSubmit);
                elements.forms.quote.addEventListener('submit', app.handleQuoteSubmit);
                elements.forms.capabilities.addEventListener('submit', app.handleCapabilitiesSubmit);
                
                // Cliques em botões
                elements.logoutBtn.addEventListener('click', app.handleLogout);
                elements.getQuoteBtn.addEventListener('click', () => app.showPage('home'));
                elements.browseManufacturersBtn.addEventListener('click', () => {
                    if (AppState.currentUser.type === 'client') {
                        app.showPage('methods');
                    } else {
                        app.showPage('fabricator');
                    }
                });
                elements.newProjectBtn.addEventListener('click', () => app.showPage('home'));
                elements.updateCapabilitiesBtn.addEventListener('click', () => app.openCapabilitiesModal());
                
                // Botões de fechar modal
                document.querySelectorAll('.close-modal').forEach(button => {
                    button.addEventListener('click', utils.closeAllModals);
                });
                
                // Fechar modal ao clicar fora
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            utils.closeAllModals();
                        }
                    });
                });
                
                // Links do rodapé
                document.querySelectorAll('.footer-column a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const id = link.id;
                        if (id && id.includes('link')) {
                            utils.showNotification(`A página "${link.textContent}" seria aberta em uma implementação completa.`, 'info');
                        }
                    });
                });
                
                // Botões de detalhes do método
                document.querySelectorAll('[data-method-detail]').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const method = e.target.getAttribute('data-method-detail');
                        app.openMethodDetailModal(method);
                    });
                });
                
                // Cards de método
                document.querySelectorAll('.method-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        if (!e.target.closest('button')) {
                            const method = card.getAttribute('data-method');
                            app.openMethodDetailModal(method);
                        }
                    });
                });
            },
            
            // Carregar dados do usuário do localStorage (simulado)
            loadUserData: () => {
                const savedUser = localStorage.getItem('fabricatehub_user');
                if (savedUser) {
                    const userData = JSON.parse(savedUser);
                    AppState.currentUser = { ...AppState.currentUser, ...userData };
                }
            },
            
            // Salvar dados do usuário no localStorage (simulado)
            saveUserData: () => {
                localStorage.setItem('fabricatehub_user', JSON.stringify(AppState.currentUser));
            },
            
            // Atualizar UI baseado no estado atual
            updateUI: () => {
                // Atualizar informações do usuário
                elements.userName.textContent = AppState.currentUser.name;
                elements.userAvatar.textContent = AppState.currentUser.name.split(' ').map(n => n[0]).join('');
                elements.userTypeBadge.textContent = AppState.currentUser.type === 'client' ? 'Cliente' : 'Fabricante';
                
                // Atualizar estatísticas do dashboard
                app.updateDashboardStats();
                
                // Atualizar conteúdo baseado na página atual
                const currentPage = Object.keys(elements.pages).find(key => 
                    elements.pages[key].classList.contains('active')
                );
                
                if (currentPage) {
                    app.loadPageContent(currentPage);
                }
            },
            
            // Mostrar página específica
            showPage: (pageName) => {
                // Ocultar todas as páginas
                Object.values(elements.pages).forEach(page => {
                    page.classList.remove('active');
                });
                
                // Remover classe ativa de todos os links de navegação
                elements.navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                
                // Mostrar página solicitada
                if (elements.pages[pageName]) {
                    elements.pages[pageName].classList.add('active');
                    document.getElementById(`nav-${pageName}`).classList.add('active');
                    
                    // Carregar conteúdo da página
                    app.loadPageContent(pageName);
                    
                    // Rolar para o topo
                    window.scrollTo(0, 0);
                }
            },
            
            // Trocar aba
            switchTab: (tabId) => {
                // Remover classe ativa de todas as abas
                elements.tabs.forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Remover classe ativa de todos os conteúdos de aba
                elements.tabContents.forEach(content => {
                    content.classList.remove('active');
                });
                
                // Adicionar classe ativa à aba selecionada
                const selectedTab = document.querySelector(`.tab[data-tab="${tabId}"]`);
                if (selectedTab) {
                    selectedTab.classList.add('active');
                }
                
                // Mostrar conteúdo correspondente da aba
                const tabContent = document.getElementById(tabId);
                if (tabContent) {
                    tabContent.classList.add('active');
                }
                
                // Carregar conteúdo para a aba
                if (tabId.startsWith('client-')) {
                    app.loadClientTabContent(tabId.replace('client-', ''));
                } else if (tabId.startsWith('fabricator-')) {
                    app.loadFabricatorTabContent(tabId.replace('fabricator-', ''));
                }
            },
            
            // Carregar conteúdo para uma página específica
            loadPageContent: (pageName) => {
                switch(pageName) {
                    case 'client':
                        app.loadClientDashboard();
                        break;
                    case 'fabricator':
                        app.loadFabricatorDashboard();
                        break;
                    case 'methods':
                        // Página de métodos é estática
                        break;
                    default:
                        // Página inicial é estática
                        break;
                }
            },
            
            // Atualizar estatísticas do dashboard
            updateDashboardStats: () => {
                if (AppState.currentUser.type === 'client') {
                    // Estatísticas do cliente
                    const clientProjects = AppState.projects.filter(p => p.clientId === AppState.currentUser.id);
                    const totalProjects = clientProjects.length;
                    const pendingQuotes = clientProjects.filter(p => p.status === 'pending').length;
                    const activeProjects = clientProjects.filter(p => p.status === 'in-progress' || p.status === 'accepted').length;
                    const totalSpent = clientProjects
                        .filter(p => p.status === 'completed' && p.acceptedQuoteId)
                        .reduce((sum, project) => {
                            const acceptedQuote = project.quotes.find(q => q.id === project.acceptedQuoteId);
                            return sum + (acceptedQuote ? acceptedQuote.amount : 0);
                        }, 0);
                    
                    elements.statElements.totalProjects.textContent = totalProjects;
                    elements.statElements.pendingQuotes.textContent = pendingQuotes;
                    elements.statElements.activeProjects.textContent = activeProjects;
                    elements.statElements.totalSpent.textContent = utils.formatCurrency(totalSpent);
                    
                    // Adicionar manipuladores de clique aos cards de estatística
                    document.getElementById('total-projects-stat').addEventListener('click', () => {
                        app.showPage('client');
                        app.switchTab('client-all');
                    });
                    document.getElementById('pending-quotes-stat').addEventListener('click', () => {
                        app.showPage('client');
                        app.switchTab('client-pending');
                    });
                    document.getElementById('active-projects-stat').addEventListener('click', () => {
                        app.showPage('client');
                        app.switchTab('client-active');
                    });
                    document.getElementById('total-spent-stat').addEventListener('click', () => {
                        app.showPage('client');
                        app.switchTab('client-completed');
                    });
                } else {
                    // Estatísticas do fabricante
                    const activeRequests = AppState.fabricatorRequests.filter(r => r.status === 'pending').length;
                    const quotesSubmitted = AppState.fabricatorQuotes.filter(q => q.fabricatorId === 201).length;
                    const jobsCompleted = AppState.fabricatorJobs.filter(j => j.status === 'completed').length;
                    const rating = AppState.fabricatorJobs
                        .filter(j => j.status === 'completed' && j.rating)
                        .reduce((sum, job, _, array) => {
                            return sum + (job.rating / array.length);
                        }, 0);
                    
                    elements.statElements.activeRequests.textContent = activeRequests;
                    elements.statElements.quotesSubmitted.textContent = quotesSubmitted;
                    elements.statElements.jobsCompleted.textContent = jobsCompleted;
                    elements.statElements.rating.textContent = rating.toFixed(1);
                    
                    // Adicionar manipuladores de clique aos cards de estatística
                    document.getElementById('active-requests-stat').addEventListener('click', () => {
                        app.showPage('fabricator');
                        app.switchTab('fabricator-new');
                    });
                    document.getElementById('quotes-submitted-stat').addEventListener('click', () => {
                        app.showPage('fabricator');
                        app.switchTab('fabricator-quotes');
                    });
                    document.getElementById('jobs-completed-stat').addEventListener('click', () => {
                        app.showPage('fabricator');
                        app.switchTab('fabricator-completed');
                    });
                }
            },
            
            // Carregar dashboard do cliente
            loadClientDashboard: () => {
                app.loadClientTabContent('all');
            },
            
            // Carregar conteúdo da aba do cliente
            loadClientTabContent: (tab) => {
                const clientProjects = AppState.projects.filter(p => p.clientId === AppState.currentUser.id);
                let filteredProjects = [];
                
                switch(tab) {
                    case 'all':
                        filteredProjects = clientProjects;
                        app.renderClientProjectsTable(filteredProjects);
                        break;
                    case 'pending':
                        filteredProjects = clientProjects.filter(p => p.status === 'pending');
                        app.renderClientProjectsCards(filteredProjects, 'client-pending-projects');
                        break;
                    case 'active':
                        filteredProjects = clientProjects.filter(p => p.status === 'in-progress' || p.status === 'accepted');
                        app.renderClientProjectsCards(filteredProjects, 'client-active-projects');
                        break;
                    case 'completed':
                        filteredProjects = clientProjects.filter(p => p.status === 'completed');
                        app.renderClientProjectsCards(filteredProjects, 'client-completed-projects');
                        break;
                }
            },
            
            // Renderizar tabela de projetos do cliente
            renderClientProjectsTable: (projects) => {
                const container = elements.containers.clientProjectsTable;
                container.innerHTML = '';
                
                if (projects.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px; color: var(--gray);">
                                <i class="fas fa-folder-open" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                                <p>Nenhum projeto encontrado. Crie seu primeiro projeto para começar!</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                projects.forEach(project => {
                    const row = document.createElement('tr');
                    const quotesCount = project.quotes.length;
                    
                    row.innerHTML = `
                        <td><strong>${project.name}</strong></td>
                        <td>${utils.formatDate(project.date)}</td>
                        <td>
                            <div class="file-info">
                                <i class="fas fa-${utils.getMethodIcon(project.method)}"></i>
                                <span>${project.method === 'cnc-machining' ? 'Usinagem CNC' : 
                                       project.method === 'laser-cutting' ? 'Corte a Laser' : 
                                       project.method === '3d-printing' ? 'Impressão 3D' : 
                                       project.method === 'prototyping' ? 'Prototipagem' : 
                                       project.method === 'wood-fabrication' ? 'Fabricação em Madeira' : 
                                       project.method === 'welding' ? 'Soldagem' : 
                                       project.method}</span>
                            </div>
                        </td>
                        <td>${quotesCount}</td>
                        <td>${utils.getStatusBadge(project.status)}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-small btn-outline view-project" data-id="${project.id}">Ver</button>
                                ${quotesCount > 0 ? `<button class="btn btn-small btn-primary view-quotes" data-id="${project.id}">Orçamentos (${quotesCount})</button>` : ''}
                                ${project.status === 'pending' ? `<button class="btn btn-small btn-danger cancel-project" data-id="${project.id}">Cancelar</button>` : ''}
                            </div>
                        </td>
                    `;
                    
                    container.appendChild(row);
                });
                
                // Adicionar ouvintes de evento aos botões
                container.querySelectorAll('.view-project').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const projectId = parseInt(e.target.getAttribute('data-id'));
                        app.openProjectDetailModal(projectId);
                    });
                });
                
                container.querySelectorAll('.view-quotes').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const projectId = parseInt(e.target.getAttribute('data-id'));
                        app.openQuoteDetailModal(projectId);
                    });
                });
                
                container.querySelectorAll('.cancel-project').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const projectId = parseInt(e.target.getAttribute('data-id'));
                        app.cancelProject(projectId);
                    });
                });
            },
            
            // Renderizar projetos do cliente como cards
            renderClientProjectsCards: (projects, containerId) => {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                
                if (projects.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-folder-open" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            <p>Nenhum projeto encontrado nesta categoria.</p>
                        </div>
                    `;
                    return;
                }
                
                projects.forEach(project => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    
                    const quotesCount = project.quotes.length;
                    const acceptedQuote = project.quotes.find(q => q.id === project.acceptedQuoteId);
                    
                    card.innerHTML = `
                        <div class="card-header">
                            <div class="card-title">
                                <h3>${project.name}</h3>
                                <p>${project.description}</p>
                                <div class="card-meta">
                                    <span><i class="far fa-calendar"></i> ${utils.formatDate(project.date)}</span>
                                    <span><i class="fas fa-industry"></i> ${project.method === 'cnc-machining' ? 'Usinagem CNC' : 
                                           project.method === 'laser-cutting' ? 'Corte a Laser' : 
                                           project.method === '3d-printing' ? 'Impressão 3D' : 
                                           project.method === 'prototyping' ? 'Prototipagem' : 
                                           project.method === 'wood-fabrication' ? 'Fabricação em Madeira' : 
                                           project.method === 'welding' ? 'Soldagem' : 
                                           project.method}</span>
                                    <span><i class="fas fa-cube"></i> ${project.material}</span>
                                    <span><i class="fas fa-hashtag"></i> Qtd: ${project.quantity}</span>
                                </div>
                            </div>
                            <div>
                                ${utils.getStatusBadge(project.status)}
                                ${quotesCount > 0 ? `
                                <div style="display: flex; align-items: center; gap: 5px; margin-top: 10px;">
                                    <div style="background-color: var(--primary); color: white; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600;">${quotesCount}</div>
                                    <span>orçamentos</span>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                        <div class="card-details">
                            <div class="detail-item">
                                <span class="detail-label">Arquivo</span>
                                <span class="detail-value">${project.fileName}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Data de Entrega</span>
                                <span class="detail-value">${utils.formatDate(project.dueDate)}</span>
                            </div>
                            ${acceptedQuote ? `
                            <div class="detail-item">
                                <span class="detail-label">Orçamento Aceito</span>
                                <span class="detail-value">${utils.formatCurrency(acceptedQuote.amount)}</span>
                            </div>
                            ` : ''}
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-small btn-outline view-project" data-id="${project.id}">Ver Detalhes</button>
                            ${quotesCount > 0 ? `<button class="btn btn-small btn-primary view-quotes" data-id="${project.id}">Ver Orçamentos (${quotesCount})</button>` : ''}
                            ${project.status === 'pending' ? `<button class="btn btn-small btn-danger cancel-project" data-id="${project.id}">Cancelar Projeto</button>` : ''}
                        </div>
                    `;
                    
                    container.appendChild(card);
                });
                
                // Adicionar ouvintes de evento aos botões
                container.querySelectorAll('.view-project').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const projectId = parseInt(e.target.getAttribute('data-id'));
                        app.openProjectDetailModal(projectId);
                    });
                });
                
                container.querySelectorAll('.view-quotes').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const projectId = parseInt(e.target.getAttribute('data-id'));
                        app.openQuoteDetailModal(projectId);
                    });
                });
                
                container.querySelectorAll('.cancel-project').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const projectId = parseInt(e.target.getAttribute('data-id'));
                        app.cancelProject(projectId);
                    });
                });
            },
            
            // Carregar dashboard do fabricante
            loadFabricatorDashboard: () => {
                app.loadFabricatorTabContent('new');
            },
            
            // Carregar conteúdo da aba do fabricante
            loadFabricatorTabContent: (tab) => {
                switch(tab) {
                    case 'new':
                        const pendingRequests = AppState.fabricatorRequests.filter(r => r.status === 'pending');
                        app.renderFabricatorRequests(pendingRequests);
                        break;
                    case 'quotes':
                        const fabricatorQuotes = AppState.fabricatorQuotes.filter(q => q.fabricatorId === 201);
                        app.renderFabricatorQuotesTable(fabricatorQuotes);
                        break;
                    case 'active':
                        const activeJobs = AppState.fabricatorJobs.filter(j => j.status === 'in-progress');
                        app.renderFabricatorJobs(activeJobs, 'fabricator-active-jobs');
                        break;
                    case 'completed':
                        const completedJobs = AppState.fabricatorJobs.filter(j => j.status === 'completed');
                        app.renderFabricatorCompletedTable(completedJobs);
                        break;
                }
            },
            
            // Renderizar solicitações do fabricante
            renderFabricatorRequests: (requests) => {
                const container = elements.containers.fabricatorNewRequests;
                container.innerHTML = '';
                
                if (requests.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-briefcase" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            <p>Nenhuma nova solicitação disponível. Volte mais tarde!</p>
                        </div>
                    `;
                    return;
                }
                
                requests.forEach(request => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    
                    card.innerHTML = `
                        <div class="card-header">
                            <div class="card-title">
                                <h3>${request.name}</h3>
                                <p>${request.description}</p>
                                <div class="card-meta">
                                    <span><i class="fas fa-user"></i> ${request.clientName}</span>
                                    <span><i class="far fa-calendar"></i> Publicado: ${utils.formatDate(request.date)}</span>
                                    <span><i class="far fa-clock"></i> Entrega: ${utils.formatDate(request.dueDate)}</span>
                                </div>
                            </div>
                            <div>
                                <span class="status-badge status-pending">Nova Solicitação</span>
                            </div>
                        </div>
                        <div class="card-details">
                            <div class="detail-item">
                                <span class="detail-label">Método de Fabricação</span>
                                <span class="detail-value">${request.method === 'cnc-machining' ? 'Usinagem CNC' : 
                                       request.method === 'laser-cutting' ? 'Corte a Laser' : 
                                       request.method === '3d-printing' ? 'Impressão 3D' : 
                                       request.method === 'prototyping' ? 'Prototipagem' : 
                                       request.method === 'wood-fabrication' ? 'Fabricação em Madeira' : 
                                       request.method === 'welding' ? 'Soldagem' : 
                                       request.method}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Material</span>
                                <span class="detail-value">${request.material}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Quantidade</span>
                                <span class="detail-value">${request.quantity}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Arquivo</span>
                                <span class="detail-value">${request.fileName} (${request.fileSize})</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-small btn-outline view-request" data-id="${request.id}">Ver Detalhes</button>
                            <button class="btn btn-small btn-primary submit-quote" data-id="${request.id}">Enviar Orçamento</button>
                        </div>
                    `;
                    
                    container.appendChild(card);
                });
                
                // Adicionar ouvintes de evento aos botões
                container.querySelectorAll('.view-request').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const requestId = parseInt(e.target.getAttribute('data-id'));
                        const request = AppState.fabricatorRequests.find(r => r.id === requestId);
                        if (request) {
                            app.openProjectDetailModal(requestId, true);
                        }
                    });
                });
                
                container.querySelectorAll('.submit-quote').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const requestId = parseInt(e.target.getAttribute('data-id'));
                        const request = AppState.fabricatorRequests.find(r => r.id === requestId);
                        if (request) {
                            app.openQuoteModal(request);
                        }
                    });
                });
            },
            
            // Renderizar tabela de orçamentos do fabricante
            renderFabricatorQuotesTable: (quotes) => {
                const container = elements.containers.fabricatorQuotesTable;
                container.innerHTML = '';
                
                if (quotes.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px; color: var(--gray);">
                                <i class="fas fa-file-signature" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                                <p>Nenhum orçamento enviado ainda. Comece enviando um orçamento para um projeto!</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                quotes.forEach(quote => {
                    const row = document.createElement('tr');
                    
                    let statusBadge = '';
                    switch(quote.status) {
                        case 'pending':
                            statusBadge = '<span class="status-badge status-pending">Pendente</span>';
                            break;
                        case 'accepted':
                            statusBadge = '<span class="status-badge status-in-progress">Aceito</span>';
                            break;
                        case 'rejected':
                            statusBadge = '<span class="status-badge status-cancelled">Rejeitado</span>';
                            break;
                        case 'completed':
                            statusBadge = '<span class="status-badge status-completed">Concluído</span>';
                            break;
                    }
                    
                    row.innerHTML = `
                        <td>${quote.projectName}</td>
                        <td>${quote.clientName}</td>
                        <td>${utils.formatCurrency(quote.amount)}</td>
                        <td>${utils.formatDate(quote.date)}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-small btn-outline view-quote" data-id="${quote.id}">Ver</button>
                            </div>
                        </td>
                    `;
                    
                    container.appendChild(row);
                });
                
                // Adicionar ouvintes de evento aos botões
                container.querySelectorAll('.view-quote').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const quoteId = parseInt(e.target.getAttribute('data-id'));
                        app.openFabricatorQuoteDetailModal(quoteId);
                    });
                });
            },
            
            // Renderizar trabalhos do fabricante
            renderFabricatorJobs: (jobs, containerId) => {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                
                if (jobs.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--gray);">
                            <i class="fas fa-tasks" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            <p>Nenhum trabalho ativo. Orçamentos precisam ser aceitos pelos clientes primeiro.</p>
                        </div>
                    `;
                    return;
                }
                
                jobs.forEach(job => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    
                    const project = AppState.projects.find(p => p.id === job.projectId);
                    
                    card.innerHTML = `
                        <div class="card-header">
                            <div class="card-title">
                                <h3>${job.projectName}</h3>
                                <div class="card-meta">
                                    <span><i class="fas fa-user"></i> ${job.clientName}</span>
                                    <span><i class="far fa-calendar"></i> Iniciado: ${utils.formatDate(job.startDate)}</span>
                                    <span><i class="far fa-clock"></i> Entrega: ${utils.formatDate(job.dueDate)}</span>
                                </div>
                            </div>
                            <div>
                                <span class="status-badge status-in-progress">Em Andamento</span>
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Progresso</span>
                                <span>${job.progress}%</span>
                            </div>
                            <div style="height: 8px; background-color: #e5e7eb; border-radius: 4px; overflow: hidden;">
                                <div style="width: ${job.progress}%; height: 100%; background-color: var(--primary);"></div>
                            </div>
                        </div>
                        <div class="card-details">
                            ${project ? `
                            <div class="detail-item">
                                <span class="detail-label">Material</span>
                                <span class="detail-value">${project.material}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Quantidade</span>
                                <span class="detail-value">${project.quantity}</span>
                            </div>
                            ` : ''}
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-small btn-outline update-progress" data-id="${job.id}">Atualizar Progresso</button>
                            <button class="btn btn-small btn-primary contact-client" data-id="${job.id}">Contatar Cliente</button>
                        </div>
                    `;
                    
                    container.appendChild(card);
                });
                
                // Adicionar ouvintes de evento aos botões
                container.querySelectorAll('.update-progress').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const jobId = parseInt(e.target.getAttribute('data-id'));
                        app.updateJobProgress(jobId);
                    });
                });
                
                container.querySelectorAll('.contact-client').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const jobId = parseInt(e.target.getAttribute('data-id'));
                        app.contactClient(jobId);
                    });
                });
            },
            
            // Renderizar tabela de trabalhos concluídos do fabricante
            renderFabricatorCompletedTable: (jobs) => {
                const container = elements.containers.fabricatorCompletedTable;
                container.innerHTML = '';
                
                if (jobs.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px; color: var(--gray);">
                                <i class="fas fa-check-circle" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                                <p>Nenhum trabalho concluído ainda.</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                jobs.forEach(job => {
                    const row = document.createElement('tr');
                    
                    // Criar avaliação por estrelas
                    let stars = '';
                    if (job.rating) {
                        for (let i = 0; i < 5; i++) {
                            stars += i < job.rating ? '<i class="fas fa-star" style="color: #fbbf24;"></i>' : '<i class="far fa-star" style="color: #d1d5db;"></i>';
                        }
                    } else {
                        stars = 'Não avaliado';
                    }
                    
                    row.innerHTML = `
                        <td>${job.projectName}</td>
                        <td>${job.clientName}</td>
                        <td>${utils.formatDate(job.completedDate)}</td>
                        <td>
                            ${(() => {
                                const quote = AppState.fabricatorQuotes.find(q => q.id === job.quoteId);
                                return quote ? utils.formatCurrency(quote.amount) : 'N/A';
                            })()}
                        </td>
                        <td>${stars}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-small btn-outline view-job" data-id="${job.id}">Detalhes</button>
                            </div>
                        </td>
                    `;
                    
                    container.appendChild(row);
                });
                
                // Adicionar ouvintes de evento aos botões
                container.querySelectorAll('.view-job').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const jobId = parseInt(e.target.getAttribute('data-id'));
                        utils.showNotification(`Os detalhes do trabalho seriam abertos aqui.`, 'info');
                    });
                });
            },
            
            // Manipular upload de arquivo
            handleFileUpload: (files) => {
                if (files.length > 0) {
                    elements.uploadArea.innerHTML = `
                        <div class="upload-icon" style="color: var(--secondary);">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3>${files.length} Arquivo${files.length > 1 ? 's' : ''} Selecionado${files.length > 1 ? 's' : ''}</h3>
                        <p>${Array.from(files).map(file => file.name).join(', ')}</p>
                        <button class="btn btn-outline" style="margin-top: 20px;" id="change-files-btn">Alterar Arquivos</button>
                    `;
                    
                    // Adicionar ouvinte de evento ao novo botão
                    document.getElementById('change-files-btn').addEventListener('click', () => {
                        elements.fileInput.click();
                    });
                    
                    utils.showNotification(`${files.length} arquivo${files.length > 1 ? 's' : ''} carregado${files.length > 1 ? 's' : ''} com sucesso.`, 'success');
                }
            },
            
            // Manipular envio do formulário de projeto
            handleProjectSubmit: (e) => {
                e.preventDefault();
                
                const projectName = document.getElementById('project-name').value;
                const quantity = parseInt(document.getElementById('project-quantity').value);
                const material = document.getElementById('project-material').value;
                const method = document.getElementById('project-method').value;
                const dueDate = document.getElementById('project-due-date').value;
                const description = document.getElementById('project-description').value;
                
                // Criar novo projeto
                const newProject = {
                    id: utils.generateId(),
                    name: projectName,
                    clientId: AppState.currentUser.id,
                    clientName: AppState.currentUser.name,
                    fileName: "arquivo_carregado.stl", // Em app real, usar nome de arquivo real
                    fileSize: "2,5 MB",
                    date: new Date().toISOString().split('T')[0],
                    dueDate: dueDate,
                    method: method,
                    material: material,
                    quantity: quantity,
                    description: description,
                    status: "pending",
                    quotes: [],
                    selectedQuoteId: null,
                    acceptedQuoteId: null
                };
                
                // Adicionar ao estado
                AppState.projects.push(newProject);
                
                // Também adicionar às solicitações do fabricante se o usuário for um cliente
                if (AppState.currentUser.type === 'client') {
                    const newRequest = {
                        id: utils.generateId(),
                        name: projectName,
                        clientId: AppState.currentUser.id,
                        clientName: AppState.currentUser.name,
                        fileName: "arquivo_carregado.stl",
                        fileSize: "2,5 MB",
                        date: new Date().toISOString().split('T')[0],
                        dueDate: dueDate,
                        method: method,
                        material: material,
                        quantity: quantity,
                        description: description,
                        status: "pending"
                    };
                    
                    AppState.fabricatorRequests.push(newRequest);
                }
                
                // Redefinir formulário
                e.target.reset();
                elements.uploadArea.innerHTML = `
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3>Arraste e Solte Seus Arquivos Aqui</h3>
                    <p>ou clique para procurar arquivos no seu computador</p>
                    <div class="file-types">
                        <span class="file-type-tag">STL</span>
                        <span class="file-type-tag">STEP</span>
                        <span class="file-type-tag">IGES</span>
                        <span class="file-type-tag">DXF</span>
                        <span class="file-type-tag">DWG</span>
                        <span class="file-type-tag">PDF</span>
                    </div>
                `;
                
                // Mostrar mensagem de sucesso
                utils.showNotification(`Projeto "${projectName}" enviado com sucesso! Fabricantes irão analisá-lo agora.`, 'success');
                
                // Atualizar UI
                app.updateUI();
                
                // Mudar para o painel do cliente
                if (AppState.currentUser.type === 'client') {
                    app.showPage('client');
                }
            },
            
            // Manipular envio do formulário de orçamento
            handleQuoteSubmit: (e) => {
                e.preventDefault();
                
                const amount = parseFloat(document.getElementById('quote-amount').value);
                const leadTime = parseInt(document.getElementById('quote-lead-time').value);
                const paymentTerms = document.getElementById('quote-payment-terms').value;
                const notes = document.getElementById('quote-notes').value;
                
                if (!AppState.currentQuoteProject) return;
                
                // Criar novo orçamento
                const newQuote = {
                    id: utils.generateId(),
                    projectId: AppState.currentQuoteProject.id,
                    projectName: AppState.currentQuoteProject.name,
                    clientId: AppState.currentQuoteProject.clientId,
                    clientName: AppState.currentQuoteProject.clientName,
                    fabricatorId: 201, // Fabricante atual
                    fabricatorName: "Usinagem de Precisão Ltda.",
                    amount: amount,
                    leadTime: leadTime,
                    date: new Date().toISOString().split('T')[0],
                    status: "pending",
                    notes: notes,
                    paymentTerms: paymentTerms
                };
                
                // Adicionar aos orçamentos do fabricante
                AppState.fabricatorQuotes.push(newQuote);
                
                // Também adicionar aos orçamentos do projeto
                const project = AppState.projects.find(p => p.id === AppState.currentQuoteProject.id);
                if (project) {
                    project.quotes.push({
                        id: newQuote.id,
                        fabricatorId: newQuote.fabricatorId,
                        fabricatorName: newQuote.fabricatorName,
                        amount: newQuote.amount,
                        leadTime: newQuote.leadTime,
                        date: newQuote.date,
                        status: "pending"
                    });
                    
                    project.status = "quoted";
                }
                
                // Atualizar o status da solicitação
                const request = AppState.fabricatorRequests.find(r => r.id === AppState.currentQuoteProject.id);
                if (request) {
                    request.status = "quoted";
                }
                
                // Redefinir formulário e fechar modal
                e.target.reset();
                utils.closeAllModals();
                
                // Mostrar mensagem de sucesso
                utils.showNotification(`Orçamento enviado para "${AppState.currentQuoteProject.name}"!`, 'success');
                
                // Atualizar UI
                app.updateUI();
            },
            
            // Manipular envio do formulário de capacidades
            handleCapabilitiesSubmit: (e) => {
                e.preventDefault();
                
                // Obter métodos selecionados
                const methodCheckboxes = document.querySelectorAll('#capabilities-form input[type="checkbox"]:checked');
                const methods = Array.from(methodCheckboxes).map(cb => cb.value);
                
                // Obter outros valores
                const minOrder = parseFloat(document.getElementById('cap-min-order').value);
                const maxSize = document.getElementById('cap-max-size').value;
                const leadTime = parseInt(document.getElementById('cap-lead-time').value);
                const materials = document.getElementById('cap-materials').value;
                
                // Atualizar capacidades
                AppState.fabricatorCapabilities = {
                    methods: methods,
                    minOrder: minOrder,
                    maxSize: maxSize,
                    leadTime: leadTime,
                    materials: materials
                };
                
                // Fechar modal
                utils.closeAllModals();
                
                // Mostrar mensagem de sucesso
                utils.showNotification('Capacidades de fabricação atualizadas com sucesso!', 'success');
                
                // Atualizar UI
                app.updateUI();
            },
            
            // Abrir modal de orçamento
            openQuoteModal: (project) => {
                AppState.currentQuoteProject = project;
                
                // Definir nome do projeto no modal
                document.getElementById('quote-project-name').value = project.name;
                
                // Abrir modal
                utils.openModal('quote');
            },
            
            // Abrir modal de detalhes do projeto
            openProjectDetailModal: (projectId, isRequest = false) => {
                let project;
                
                if (isRequest) {
                    project = AppState.fabricatorRequests.find(r => r.id === projectId);
                } else {
                    project = AppState.projects.find(p => p.id === projectId);
                }
                
                if (!project) return;
                
                const modalContent = document.getElementById('project-detail-content');
                const quotes = project.quotes || [];
                
                modalContent.innerHTML = `
                    <div class="card" style="box-shadow: none; border: none; padding: 0;">
                        <div class="card-header" style="border: none; padding: 0 0 20px 0;">
                            <div class="card-title">
                                <h3>${project.name}</h3>
                                <p>${project.description}</p>
                            </div>
                        </div>
                        
                        <div class="card-details">
                            <div class="detail-item">
                                <span class="detail-label">Cliente</span>
                                <span class="detail-value">${project.clientName}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Data de Publicação</span>
                                <span class="detail-value">${utils.formatDate(project.date)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Data de Entrega</span>
                                <span class="detail-value">${utils.formatDate(project.dueDate)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Status</span>
                                <span class="detail-value">${utils.getStatusBadge(project.status)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Método de Fabricação</span>
                                <span class="detail-value">${project.method === 'cnc-machining' ? 'Usinagem CNC' : 
                                       project.method === 'laser-cutting' ? 'Corte a Laser' : 
                                       project.method === '3d-printing' ? 'Impressão 3D' : 
                                       project.method === 'prototyping' ? 'Prototipagem' : 
                                       project.method === 'wood-fabrication' ? 'Fabricação em Madeira' : 
                                       project.method === 'welding' ? 'Soldagem' : 
                                       project.method}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Material</span>
                                <span class="detail-value">${project.material}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Quantidade</span>
                                <span class="detail-value">${project.quantity}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Arquivo</span>
                                <span class="detail-value">${project.fileName} (${project.fileSize})</span>
                            </div>
                        </div>
                        
                        ${quotes.length > 0 ? `
                        <div style="margin-top: 20px;">
                            <h4>Orçamentos Recebidos (${quotes.length})</h4>
                            ${quotes.map(quote => `
                                <div class="quote-card">
                                    <div class="quote-card-header">
                                        <div>
                                            <strong>${quote.fabricatorName}</strong>
                                            <div>${utils.formatCurrency(quote.amount)} • ${quote.leadTime} dias</div>
                                        </div>
                                        <div>
                                            ${quote.status === 'accepted' ? 
                                                '<span class="status-badge status-completed">Aceito</span>' : 
                                                '<span class="status-badge status-pending">Pendente</span>'
                                            }
                                        </div>
                                    </div>
                                    <p>Enviado em ${utils.formatDate(quote.date)}</p>
                                    ${AppState.currentUser.type === 'client' && quote.status === 'pending' ? `
                                    <div class="quote-card-actions">
                                        <button class="btn btn-small btn-primary accept-quote" data-quote-id="${quote.id}" data-project-id="${project.id}">Aceitar Orçamento</button>
                                        <button class="btn btn-small btn-outline">Mensagem</button>
                                    </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                        ` : ''}
                    </div>
                `;
                
                // Adicionar ouvintes de evento aos botões de aceitar orçamento
                modalContent.querySelectorAll('.accept-quote').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const quoteId = parseInt(e.target.getAttribute('data-quote-id'));
                        const projectId = parseInt(e.target.getAttribute('data-project-id'));
                        app.acceptQuote(projectId, quoteId);
                    });
                });
                
                // Abrir modal
                utils.openModal('project-detail');
            },
            
            // Abrir modal de detalhes do orçamento
            openQuoteDetailModal: (projectId) => {
                const project = AppState.projects.find(p => p.id === projectId);
                if (!project || project.quotes.length === 0) return;
                
                const modalContent = document.getElementById('quote-detail-content');
                
                modalContent.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <h3>${project.name}</h3>
                        <p>Você recebeu ${project.quotes.length} orçamento${project.quotes.length > 1 ? 's' : ''} para este projeto.</p>
                    </div>
                    
                    ${project.quotes.map(quote => `
                        <div class="quote-card" style="margin-bottom: 15px;">
                            <div class="quote-card-header">
                                <div>
                                    <strong>${quote.fabricatorName}</strong>
                                    <div style="display: flex; gap: 15px; margin-top: 5px;">
                                        <span><i class="fas fa-dollar-sign"></i> ${utils.formatCurrency(quote.amount)}</span>
                                        <span><i class="far fa-clock"></i> ${quote.leadTime} dias</span>
                                        <span><i class="far fa-calendar"></i> ${utils.formatDate(quote.date)}</span>
                                    </div>
                                </div>
                                <div>
                                    ${quote.status === 'accepted' ? 
                                        '<span class="status-badge status-completed">Aceito</span>' : 
                                        '<span class="status-badge status-pending">Pendente</span>'
                                    }
                                </div>
                            </div>
                            
                            ${quote.status === 'pending' ? `
                            <div class="quote-card-actions">
                                <button class="btn btn-small btn-primary accept-quote" data-quote-id="${quote.id}" data-project-id="${project.id}">Aceitar Orçamento</button>
                                <button class="btn btn-small btn-outline">Mensagem ao Fabricante</button>
                                <button class="btn btn-small btn-outline">Solicitar Revisão</button>
                            </div>
                            ` : ''}
                        </div>
                    `).join('')}
                `;
                
                // Adicionar ouvintes de evento aos botões de aceitar orçamento
                modalContent.querySelectorAll('.accept-quote').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const quoteId = parseInt(e.target.getAttribute('data-quote-id'));
                        const projectId = parseInt(e.target.getAttribute('data-project-id'));
                        app.acceptQuote(projectId, quoteId);
                    });
                });
                
                // Abrir modal
                utils.openModal('quote-detail');
            },
            
            // Abrir modal de detalhes do orçamento do fabricante
            openFabricatorQuoteDetailModal: (quoteId) => {
                const quote = AppState.fabricatorQuotes.find(q => q.id === quoteId);
                if (!quote) return;
                
                const modalContent = document.getElementById('quote-detail-content');
                
                modalContent.innerHTML = `
                    <div class="card" style="box-shadow: none; border: none; padding: 0;">
                        <div class="card-header" style="border: none; padding: 0 0 20px 0;">
                            <div class="card-title">
                                <h3>${quote.projectName}</h3>
                                <p>Orçamento enviado para ${quote.clientName}</p>
                            </div>
                        </div>
                        
                        <div class="card-details">
                            <div class="detail-item">
                                <span class="detail-label">Valor do Orçamento</span>
                                <span class="detail-value">${utils.formatCurrency(quote.amount)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Prazo de Entrega</span>
                                <span class="detail-value">${quote.leadTime} dias</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Data de Envio</span>
                                <span class="detail-value">${utils.formatDate(quote.date)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Status</span>
                                <span class="detail-value">${utils.getStatusBadge(quote.status)}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Condições de Pagamento</span>
                                <span class="detail-value">${quote.paymentTerms || 'Não especificado'}</span>
                            </div>
                        </div>
                        
                        ${quote.notes ? `
                        <div style="margin-top: 20px;">
                            <h4>Observações</h4>
                            <p>${quote.notes}</p>
                        </div>
                        ` : ''}
                        
                        ${quote.status === 'pending' ? `
                        <div class="card-actions" style="margin-top: 20px;">
                            <button class="btn btn-small btn-outline" id="withdraw-quote" data-id="${quote.id}">Retirar Orçamento</button>
                            <button class="btn btn-small btn-primary" id="revise-quote" data-id="${quote.id}">Revisar Orçamento</button>
                        </div>
                        ` : ''}
                    </div>
                `;
                
                // Adicionar ouvintes de evento
                if (quote.status === 'pending') {
                    modalContent.querySelector('#withdraw-quote').addEventListener('click', (e) => {
                        const quoteId = parseInt(e.target.getAttribute('data-id'));
                        app.withdrawQuote(quoteId);
                    });
                    
                    modalContent.querySelector('#revise-quote').addEventListener('click', (e) => {
                        const quoteId = parseInt(e.target.getAttribute('data-id'));
                        app.reviseQuote(quoteId);
                    });
                }
                
                // Abrir modal
                utils.openModal('quote-detail');
            },
            
            // Abrir modal de detalhes do método
            openMethodDetailModal: (method) => {
                const methodDetails = {
                    'cnc-machining': {
                        title: 'Usinagem CNC',
                        description: 'Usinagem CNC (Controle Numérico Computadorizado) é um processo de fabricação no qual software de computador pré-programado dita o movimento das ferramentas e maquinário da fábrica.',
                        details: `
                            <p><strong>Capacidades:</strong></p>
                            <ul>
                                <li>Fresamento 3, 4 e 5 eixos</li>
                                <li>Trabalho de torno e torneamento</li>
                                <li>Geometrias e contornos complexos</li>
                                <li>Tolerâncias apertadas (±0,001" / 0,025mm)</li>
                                <li>Ampla gama de materiais</li>
                            </ul>
                            
                            <p><strong>Aplicações Comuns:</strong></p>
                            <ul>
                                <li>Componentes de precisão</li>
                                <li>Peças de motor</li>
                                <li>Ferramental e moldes</li>
                                <li>Protipos e peças de uso final</li>
                                <li>Montagens complexas</li>
                            </ul>
                            
                            <p><strong>Prazo de Entrega Típico:</strong> 1-3 semanas</p>
                            <p><strong>Melhor Para:</strong> Peças de alta precisão, componentes metálicos, geometrias complexas</p>
                        `
                    },
                    'laser-cutting': {
                        title: 'Corte a Laser',
                        description: 'O corte a laser usa um laser de alta potência para cortar materiais com extrema precisão, criando bordas limpas com zonas termicamente afetadas mínimas.',
                        details: `
                            <p><strong>Capacidades:</strong></p>
                            <ul>
                                <li>Chapa metálica até 1" de espessura</li>
                                <li>Designs e padrões intrincados</li>
                                <li>Entrega rápida para peças planas</li>
                                <li>Múltiplos materiais (metais, plásticos, madeira)</li>
                                <li>Alta precisão (±0,005" / 0,127mm)</li>
                            </ul>
                            
                            <p><strong>Aplicações Comuns:</strong></p>
                            <ul>
                                <li>Componentes de chapa metálica</li>
                                <li>Painéis decorativos</li>
                                <li>Sinalização e displays</li>
                                <li>Proteções e invólucros de máquinas</li>
                                <li>Elementos arquitetônicos</li>
                            </ul>
                            
                            <p><strong>Prazo de Entrega Típico:</strong> 3-10 dias</p>
                            <p><strong>Melhor Para:</strong> Peças planas, chapa metálica, recortes intrincados</p>
                        `
                    },
                    '3d-printing': {
                        title: 'Impressão 3D',
                        description: 'Manufatura aditiva que constrói peças camada por camada a partir de modelos digitais, ideal para geometrias complexas e prototipagem rápida.',
                        details: `
                            <p><strong>Tecnologias Disponíveis:</strong></p>
                            <ul>
                                <li>FDM (Modelagem por Fusão e Deposição)</li>
                                <li>SLA (Estereolitografia)</li>
                                <li>SLS (Sinterização Seletiva a Laser)</li>
                                <li>Impressão 3D em Metal</li>
                                <li>Impressão multi-material</li>
                            </ul>
                            
                            <p><strong>Aplicações Comuns:</strong></p>
                            <ul>
                                <li>Prototipagem rápida</li>
                                <li>Gabinetes e suportes personalizados</li>
                                <li>Estruturas internas complexas</li>
                                <li>Produção de baixo volume</li>
                                <li>Peças médicas e dentárias</li>
                            </ul>
                            
                            <p><strong>Prazo de Entrega Típico:</strong> 2-7 dias</p>
                            <p><strong>Melhor Para:</strong> Protótipos, geometrias complexas, peças personalizadas</p>
                        `
                    },
                    'prototyping': {
                        title: 'Prototipagem',
                        description: 'Serviços de prototipagem rápida para criar rapidamente modelos físicos para validação de design, testes e apresentação.',
                        details: `
                            <p><strong>Serviços Oferecidos:</strong></p>
                            <ul>
                                <li>Modelos conceituais</li>
                                <li>Protipos funcionais</li>
                                <li>Validação de design</li>
                                <li>Amostras para testes de usuário</li>
                                <li>Desenvolvimento iterativo</li>
                            </ul>
                            
                            <p><strong>Aplicações Comuns:</strong></p>
                            <ul>
                                <li>Desenvolvimento de produto</li>
                                <li>Verificação de design</li>
                                <li>Apresentações para investidores</li>
                                <li>Testes de mercado</li>
                                <li>Campanhas de crowdfunding</li>
                            </ul>
                            
                            <p><strong>Prazo de Entrega Típico:</strong> 3-14 dias</p>
                            <p><strong>Melhor Para:</strong> Desenvolvimento de novos produtos, validação de design</p>
                        `
                    },
                    'wood-fabrication': {
                        title: 'Fabricação em Madeira',
                        description: 'Serviços de marcenaria e carpintaria personalizados para móveis, elementos arquitetônicos e peças decorativas.',
                        details: `
                            <p><strong>Capacidades:</strong></p>
                            <ul>
                                <li>Roteamento CNC em madeira</li>
                                <li>Móveis personalizados</li>
                                <li>Marcenaria arquitetônica</li>
                                <li>Juntas (cauda de andorinha, espiga e entalhe)</li>
                                <li>Acabamento e tingimento</li>
                            </ul>
                            
                            <p><strong>Aplicações Comuns:</strong></p>
                            <ul>
                                <li>Móveis personalizados</li>
                                <li>Armários e embutidos</li>
                                <li>Detalhes arquitetônicos</li>
                                <li>Sinalização e displays</li>
                                <li>Arte e esculturas</li>
                            </ul>
                            
                            <p><strong>Prazo de Entrega Típico:</strong> 2-4 semanas</p>
                            <p><strong>Melhor Para:</strong> Móveis, marcenaria arquitetônica, peças personalizadas</p>
                        `
                    },
                    'welding': {
                        title: 'Soldagem e Fabricação',
                        description: 'Serviços de fabricação e soldagem metálica para componentes estruturais, quadros e montagens personalizadas.',
                        details: `
                            <p><strong>Processos Disponíveis:</strong></p>
                            <ul>
                                <li>Solda TIG (precisão)</li>
                                <li>Solda MIG (produção)</li>
                                <li>Solda com eletrodo revestido (pesada)</li>
                                <li>Corte a plasma</li>
                                <li>Dobra e conformação de metais</li>
                            </ul>
                            
                            <p><strong>Aplicações Comuns:</strong></p>
                            <ul>
                                <li>Aço estrutural</li>
                                <li>Quadros e racks personalizados</li>
                                <li>Montagens de tubos e tubulações</li>
                                <li>Proteções e invólucros de máquinas</li>
                                <li>Arte e escultura</li>
                            </ul>
                            
                            <p><strong>Prazo de Entrega Típico:</strong> 1-3 semanas</p>
                            <p><strong>Melhor Para:</strong> Componentes estruturais, quadros metálicos, montagens personalizadas</p>
                        `
                    }
                };
                
                const detail = methodDetails[method] || methodDetails['cnc-machining'];
                
                document.getElementById('method-detail-title').textContent = detail.title;
                document.getElementById('method-detail-content').innerHTML = `
                    <p>${detail.description}</p>
                    ${detail.details}
                `;
                
                // Configurar botão de buscar projetos
                document.getElementById('method-browse-projects').addEventListener('click', () => {
                    utils.closeAllModals();
                    if (AppState.currentUser.type === 'fabricator') {
                        app.showPage('fabricator');
                    } else {
                        app.showPage('methods');
                    }
                });
                
                utils.openModal('method-detail');
            },
            
            // Abrir modal de capacidades
            openCapabilitiesModal: () => {
                // Definir valores atuais
                const caps = AppState.fabricatorCapabilities;
                
                // Marcar caixas de seleção de métodos
                document.querySelectorAll('#capabilities-form input[type="checkbox"]').forEach(checkbox => {
                    checkbox.checked = caps.methods.includes(checkbox.value);
                });
                
                // Definir outros valores
                document.getElementById('cap-min-order').value = caps.minOrder;
                document.getElementById('cap-max-size').value = caps.maxSize;
                document.getElementById('cap-lead-time').value = caps.leadTime;
                document.getElementById('cap-materials').value = caps.materials;
                
                utils.openModal('capabilities');
            },
            
            // Manipular logout
            handleLogout: () => {
                if (confirm('Tem certeza que deseja sair?')) {
                    utils.showNotification('Sessão encerrada com sucesso. Redirecionando para o login...', 'success');
                    setTimeout(() => {
                        // Em um app real, isso redirecionaria para a página de login
                        alert('Em uma implementação completa, isso redirecionaria para a página de login.');
                    }, 1500);
                }
            },
            
            // Aceitar um orçamento
            acceptQuote: (projectId, quoteId) => {
                const project = AppState.projects.find(p => p.id === projectId);
                const quote = project.quotes.find(q => q.id === quoteId);
                
                if (project && quote) {
                    // Atualizar projeto
                    project.status = 'in-progress';
                    project.selectedQuoteId = quoteId;
                    project.acceptedQuoteId = quoteId;
                    
                    // Atualizar status do orçamento
                    quote.status = 'accepted';
                    
                    // Atualizar orçamento do fabricante
                    const fabricatorQuote = AppState.fabricatorQuotes.find(q => q.id === quoteId);
                    if (fabricatorQuote) {
                        fabricatorQuote.status = 'accepted';
                    }
                    
                    // Criar um trabalho para o fabricante
                    const newJob = {
                        id: utils.generateId(),
                        projectId: projectId,
                        projectName: project.name,
                        clientId: project.clientId,
                        clientName: project.clientName,
                        quoteId: quoteId,
                        startDate: new Date().toISOString().split('T')[0],
                        dueDate: project.dueDate,
                        status: 'in-progress',
                        progress: 10
                    };
                    
                    AppState.fabricatorJobs.push(newJob);
                    
                    // Fechar modais
                    utils.closeAllModals();
                    
                    // Mostrar mensagem de sucesso
                    utils.showNotification(`Orçamento aceito! O projeto "${project.name}" está agora em andamento.`, 'success');
                    
                    // Atualizar UI
                    app.updateUI();
                }
            },
            
            // Cancelar um projeto
            cancelProject: (projectId) => {
                if (confirm('Tem certeza que deseja cancelar este projeto?')) {
                    const project = AppState.projects.find(p => p.id === projectId);
                    if (project) {
                        project.status = 'cancelled';
                        
                        // Também cancelar quaisquer solicitações associadas
                        const request = AppState.fabricatorRequests.find(r => 
                            r.name === project.name && r.clientId === project.clientId
                        );
                        if (request) {
                            request.status = 'cancelled';
                        }
                        
                        utils.showNotification(`Projeto "${project.name}" foi cancelado.`, 'success');
                        app.updateUI();
                    }
                }
            },
            
            // Retirar um orçamento
            withdrawQuote: (quoteId) => {
                if (confirm('Tem certeza que deseja retirar este orçamento?')) {
                    const quote = AppState.fabricatorQuotes.find(q => q.id === quoteId);
                    if (quote) {
                        quote.status = 'rejected';
                        
                        // Também atualizar orçamento do projeto
                        const project = AppState.projects.find(p => p.id === quote.projectId);
                        if (project) {
                            const projectQuote = project.quotes.find(q => q.id === quoteId);
                            if (projectQuote) {
                                projectQuote.status = 'rejected';
                            }
                            
                            // Se nenhum orçamento restar, definir projeto de volta para pendente
                            const pendingQuotes = project.quotes.filter(q => q.status === 'pending');
                            if (pendingQuotes.length === 0) {
                                project.status = 'pending';
                            }
                        }
                        
                        utils.closeAllModals();
                        utils.showNotification('Orçamento retirado com sucesso.', 'success');
                        app.updateUI();
                    }
                }
            },
            
            // Revisar um orçamento
            reviseQuote: (quoteId) => {
                const quote = AppState.fabricatorQuotes.find(q => q.id === quoteId);
                if (quote) {
                    const project = AppState.fabricatorRequests.find(r => 
                        r.name === quote.projectName && r.clientId === quote.clientId
                    );
                    
                    if (project) {
                        app.openQuoteModal(project);
                    }
                }
            },
            
            // Atualizar progresso do trabalho
            updateJobProgress: (jobId) => {
                const job = AppState.fabricatorJobs.find(j => j.id === jobId);
                if (job) {
                    const newProgress = prompt(`Digite a nova porcentagem de progresso para "${job.projectName}":`, job.progress);
                    if (newProgress !== null) {
                        const progress = parseInt(newProgress);
                        if (!isNaN(progress) && progress >= 0 && progress <= 100) {
                            job.progress = progress;
                            
                            // Se o progresso for 100%, marcar como concluído
                            if (progress === 100) {
                                job.status = 'completed';
                                job.completedDate = new Date().toISOString().split('T')[0];
                                
                                // Também atualizar projeto
                                const project = AppState.projects.find(p => p.id === job.projectId);
                                if (project) {
                                    project.status = 'completed';
                                }
                                
                                // Atualizar orçamento
                                const quote = AppState.fabricatorQuotes.find(q => q.id === job.quoteId);
                                if (quote) {
                                    quote.status = 'completed';
                                }
                            }
                            
                            utils.showNotification(`Progresso atualizado para ${progress}% em "${job.projectName}".`, 'success');
                            app.updateUI();
                        } else {
                            utils.showNotification('Por favor, digite uma porcentagem válida entre 0 e 100.', 'error');
                        }
                    }
                }
            },
            
            // Contatar cliente
            contactClient: (jobId) => {
                const job = AppState.fabricatorJobs.find(j => j.id === jobId);
                if (job) {
                    const message = prompt(`Digite mensagem para ${job.clientName} sobre "${job.projectName}":`, '');
                    if (message !== null && message.trim() !== '') {
                        utils.showNotification(`Mensagem enviada para ${job.clientName}.`, 'success');
                    }
                }
            }
        };

        // ==================== INICIALIZAR APLICAÇÃO ====================
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

        // ==================== OUVINTES DE EVENTO DA JANELA ====================
        // Fechar modais com tecla Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                utils.closeAllModals();
            }
        });
    </script>
</body>
</html>
